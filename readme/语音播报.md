### **语音播报**

了解本章后，你可以定制属于自己的语音库。

语音库包含两大部分，播报格式和音频文件。

#### Announcer的播报格式

Announcer的播报都是由若干个语句拼接而成的，而格式描述的是播报的内容和顺序。来看看下面这段格式。

`车辆启动|请站稳扶好|前方到站|<nscn>|下车乘客请准备`

每个语句用`|`分割开来，其中像`车辆启动`和`下车乘客请准备`这样的是普通语句。

而像`<nscn>`这样用一对尖括号包裹起来的内容，就是占位符语句。`<nscn>`代表的是*当前站点的中文名称*。

占位符语句主要有两类，一类是`站点名称占位符`。

站点名称占位符由两部分组成，第一部分表示站点在路线中的位置，第二部分表示站点的语种，如下表所示。

|    | cn     | en     | yue    |
|----|--------|--------|--------|
| ns | 当前站点中文 | 当前站点英文 | 当前站点粤语 |
| ss | 起点站中文  | 起点站英文  | 起点站粤语  |
| ts | 终点站中文  | 终点站英文  | 终点站粤语  |

其中，中文和英文是必须的，此外，你也可以自定义语种，例如表中的粤语。

注意：站点名称占位符要求顺序一致。如果要表示`终点站粤语`，不能使用`<yuets>`，正确用法是`<tsyue>`。

还有一些`其他占位符`，如下表所示。

| 占位符        | 含义     |
|------------|--------|
| `<line>`   | 当前路线名称 |
| `<time>`   | 当前时间   |
| `<hour>`   | 当前小时数  |
| `<hour>`   | 当前分钟数  |
| `<second>` | 当前秒数   |
| `<speed>`  | 当前速度   |

在`设置`-`语音播报库`中，可以自定义播报格式。

#### Announcer的音频文件

Announcer会按照播报格式在语音库中寻找对应的语音。

1. 对于常规语句，Announcer会在`Announcer/Media/[语音库名称]`下所有语种的`common`文件夹中查找文件名为语句文本的音频文件。

2. 对于站点占位符语句，Announcer会在`Announcer/Media/[语音库名称]/[语种]/station`中查找文件名为站点名称的音频文件。

3. 对于其他占位符语句，Announcer按照特定的规则处理。

来看看下面这段格式。

`<nscn>|到了|请从后门下车|We are arriving at|<nsen>`

假设当前站点为`桂林北站(Guilin North Station)`，语音库为`MicroBus`

1. 对于`到了`，Announcer会在`Announcer/Media/MicroBus/cn/common` `Announcer/Media/MicroBus/en/common`
   等文件夹中查找文件名为`到了`的音频文件并播报。（如果存在对应文件）

2. 对于`<nsen>`，Announcer会在`Announcer/Media/MicroBus/en/station`中查找文件名为
   `Guilin North Station`的音频文件。 此时文件夹中如果存在 `Guilin North Station.wav`
   `Guilin North Station.mp3` `Guilin North Station.ogg`
   或者其他格式的音频文件，Announcer就会将其读取并播报。

尽管对于常规语句，Announcer会不区分语种地进行查找，但还是建议您按语种存放音频文件。

如果找不到对应的音频文件，且您启用了`TTS播报`，Announcer会调用系统的`文字转语音服务`进行播报。
